% Define Language
\lstdefinelanguage{futhark}
{
  % list of keywords
  morekeywords={
    do,
    else,
    for,
    fun,
    if,
    in,
    include,
    let,
    loop,
    struct,
    then,
    type,
    val,
    while,
    with,
    module,
    where,
  },
  sensitive=true, % keywords are not case-sensitive
  morecomment=[l]{--}, % l is for line comment
  morecomment=[s]{\{-}{-\}}, % s is for start and end delimiter
%  otherkeywords={>,<,=,<=,>=,!,*,/,-,+,|,&,||,&&,==,=>},
  morestring=[b]" % defines that strings are enclosed in double quotes
}

\lstdefinelanguage{corefuthark}
{
  % list of keywords
  morekeywords={
    do,
    else,
    for,
    fun,
    if,
    in,
    include,
    let,
    loop,
    struct,
    then,
    type,
    val,
    while,
    with,
    module,
    where,
  },
  sensitive=true, % keywords are not case-sensitive
  literate={\\}{\fn}{1} {->}{$\rightarrow$}{1} {<-}{$\leftarrow$}{1},
  moredelim=**[is][\color{red}]{@}{@},
  morecomment=[l]{--}, % l is for line comment
  morecomment=[s]{\{-}{-\}}, % s is for start and end delimiter
%  otherkeywords={>,<,=,<=,>=,!,*,/,-,+,|,&,||,&&,==,=>},
  morestring=[b]" % defines that strings are enclosed in double quotes
}

% Define Colors
\usepackage{xcolor}
\definecolor{eclipseBlue}{RGB}{42,0.0,255}
\definecolor{eclipseGreen}{RGB}{63,127,95}
\definecolor{eclipsePurple}{RGB}{127,0,85}

\newcommand{\fop}[1]{\mbox{\ttfamily\color{eclipseBlue}#1}}
\newcommand{\fw}[1]{\mbox{\ttfamily\bfseries\color{eclipsePurple}#1}}

% Set Language
\lstset{
  language={futhark},
  basicstyle=\ttfamily, % Global Code Style
  extendedchars=true, % Allows 256 instead of 128 ASCII characters
  tabsize=2, % number of spaces indented when discovering a tab
  columns=fixed, % make all characters equal width
  keepspaces=true, % does not ignore spaces to fit width, convert tabs to spaces
  showstringspaces=false, % lets spaces in strings appear as real spaces
  numbers=none, % do not show line numbers at the left
  numberstyle=\small\ttfamily, % style of the line numbers
  commentstyle=\slshape\bfseries\color{eclipseGreen}, % style of comments
  keywordstyle=\bfseries, % style of keywords
  stringstyle=\color{eclipseBlue}, % style of strings
  emph=[1] {
    false,
    filter,
    iota,
    map,
    partition,
    rearrange,
    reduce,
    reduce_comm,
    redomap,
    scanomap,
    replicate,
    reshape,
    rotate,
    shape,
    scan,
    split,
    true,
    unzip,
    scatter,
    zip,
    stream_seq,
    stream_red,
    stream_map,
    stream_par,
    size,
    manifest,
    local,
    kernel,
    stream_group,
  },
  emphstyle=\ttfamily\bfseries,
  moredelim=**[is][\color{red}]{@}{@},
  aboveskip=-0.1\baselineskip,
  belowskip=\baselineskip,
}

\newcommand{\kt}[1]{\textsf{#1}}
\newcommand{\kw}[1]{\mbox{\texttt{\bfseries{#1}}}}
\newcommand{\id}[1]{\mbox{\it{#1}}}
\def\M{\kw{M}}
\newcommand{\Mv}[2]{\M~\overline{#1}~\overline{#2}}
\newcommand{\Do}{\kw{do}}
%\newcommand{\For}{\kw{for}}
\newcommand{\map}{\kw{map}}
\newcommand{\Map}{\kw{map}}
\newcommand{\Reduce}{\kw{reduce}}
\newcommand{\Redomap}{\kw{redomap}}
\newcommand{\Scan}{\kw{scan}}
\newcommand{\Transpose}{\kw{transpose}}
\newcommand{\Let}[3]{\kw{let}~#1~\mbox{\texttt{=}}~#2~\kw{in}~#3}
%\newcommand{\If}[3]{\kw{if}~#1~\kw{then}~#2~\kw{else}~#3}
%\newcommand{\Loop}[5]{\kw{loop}~#1~\texttt{=}~#2~\kw{for}~#3<#4~\kw{do}~#5}
\newcommand{\vd}{\vdash}
\newcommand{\Rearrange}{\kw{rearrange}}
\newcommand{\Replicate}{\kw{replicate}}
\newcommand{\Par}[1]{\mathtt{(}#1\mathtt{)}}
\newcommand{\Set}[1]{\{#1\}}
\newcommand{\StreamMap}{\kw{stream\_map}}
\newcommand{\StreamRed}{\kw{stream\_red}}
\newcommand{\StreamPar}{\kw{stream\_par}}
\newcommand{\StreamSeq}{\kw{stream\_seq}}
\newcommand{\StreamGroup}{\kw{stream\_group}}
\newcommand{\ov}[1]{\overline{#1}}
\newcommand{\nseq}[2]{\overline{#1}^{(#2)}}
\newcommand{\seq}[1]{\overline{#1}}


